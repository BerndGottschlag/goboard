(kicad_sch (version 20201015) (generator eeschema)

  (paper "A4")

  (lib_symbols
    (symbol "Device:Battery_Cell" (pin_numbers hide) (pin_names (offset 0) hide) (in_bom yes) (on_board yes)
      (property "Reference" "BT" (id 0) (at 2.54 2.54 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Value" "Battery_Cell" (id 1) (at 2.54 0 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Footprint" "" (id 2) (at 0 1.524 90)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "~" (id 3) (at 0 1.524 90)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "battery cell" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Single-cell battery" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "Battery_Cell_0_1"
        (rectangle (start -2.286 1.778) (end 2.286 1.524)
          (stroke (width 0)) (fill (type outline))
        )
        (rectangle (start -1.5748 1.1938) (end 1.4732 0.6858)
          (stroke (width 0)) (fill (type outline))
        )
        (polyline
          (pts
            (xy 0 0.762)
            (xy 0 0)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0 1.778)
            (xy 0 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.508 3.429)
            (xy 1.524 3.429)
          )
          (stroke (width 0.254)) (fill (type none))
        )
        (polyline
          (pts
            (xy 1.016 3.937)
            (xy 1.016 2.921)
          )
          (stroke (width 0.254)) (fill (type none))
        )
      )
      (symbol "Battery_Cell_1_1"
        (pin passive line (at 0 5.08 270) (length 2.54)
          (name "+" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 0 -2.54 90) (length 2.54)
          (name "-" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "Device:Q_PMOS_DGS" (pin_names (offset 0) hide) (in_bom yes) (on_board yes)
      (property "Reference" "Q" (id 0) (at 5.08 1.27 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Value" "Q_PMOS_DGS" (id 1) (at 5.08 -1.27 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Footprint" "" (id 2) (at 5.08 2.54 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "~" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "transistor PMOS P-MOS P-MOSFET" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "P-MOSFET transistor, drain/gate/source" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "Q_PMOS_DGS_0_1"
        (circle (center 1.651 0) (radius 2.794) (stroke (width 0.254)) (fill (type none)))
        (circle (center 2.54 -1.778) (radius 0.254) (stroke (width 0)) (fill (type outline)))
        (circle (center 2.54 1.778) (radius 0.254) (stroke (width 0)) (fill (type outline)))
        (polyline
          (pts
            (xy 0.254 0)
            (xy -2.54 0)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.254 1.905)
            (xy 0.254 -1.905)
          )
          (stroke (width 0.254)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 -1.27)
            (xy 0.762 -2.286)
          )
          (stroke (width 0.254)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 0.508)
            (xy 0.762 -0.508)
          )
          (stroke (width 0.254)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 2.286)
            (xy 0.762 1.27)
          )
          (stroke (width 0.254)) (fill (type none))
        )
        (polyline
          (pts
            (xy 2.54 2.54)
            (xy 2.54 1.778)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 2.54 -2.54)
            (xy 2.54 0)
            (xy 0.762 0)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 1.778)
            (xy 3.302 1.778)
            (xy 3.302 -1.778)
            (xy 0.762 -1.778)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 2.286 0)
            (xy 1.27 0.381)
            (xy 1.27 -0.381)
            (xy 2.286 0)
          )
          (stroke (width 0)) (fill (type outline))
        )
        (polyline
          (pts
            (xy 2.794 -0.508)
            (xy 2.921 -0.381)
            (xy 3.683 -0.381)
            (xy 3.81 -0.254)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 3.302 -0.381)
            (xy 2.921 0.254)
            (xy 3.683 0.254)
            (xy 3.302 -0.381)
          )
          (stroke (width 0)) (fill (type none))
        )
      )
      (symbol "Q_PMOS_DGS_1_1"
        (pin passive line (at 2.54 5.08 270) (length 2.54)
          (name "D" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin input line (at -5.08 0 0) (length 2.54)
          (name "G" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 2.54 -5.08 90) (length 2.54)
          (name "S" (effects (font (size 1.27 1.27))))
          (number "3" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "Device:R" (pin_numbers hide) (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "R" (id 0) (at 2.032 0 90)
        (effects (font (size 1.27 1.27)))
      )
      (property "Value" "R" (id 1) (at 0 0 90)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (id 2) (at -1.778 0 90)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "~" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "R res resistor" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Resistor" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_fp_filters" "R_*" (id 6) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "R_0_1"
        (rectangle (start -1.016 -2.54) (end 1.016 2.54)
          (stroke (width 0.254)) (fill (type none))
        )
      )
      (symbol "R_1_1"
        (pin passive line (at 0 3.81 270) (length 1.27)
          (name "~" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 0 -3.81 90) (length 1.27)
          (name "~" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "Transistor_BJT:BC807" (pin_names (offset 0) hide) (in_bom yes) (on_board yes)
      (property "Reference" "Q" (id 0) (at 5.08 1.905 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Value" "BC807" (id 1) (at 5.08 0 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Footprint" "Package_TO_SOT_SMD:SOT-23" (id 2) (at 5.08 -1.905 0)
        (effects (font (size 1.27 1.27) italic) (justify left) hide)
      )
      (property "Datasheet" "https://www.onsemi.com/pub/Collateral/BC808-D.pdf" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) (justify left) hide)
      )
      (property "ki_keywords" "PNP Transistor" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "0.8A Ic, 45V Vce, PNP Transistor, SOT-23" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_fp_filters" "SOT?23*" (id 6) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "BC807_0_1"
        (circle (center 1.27 0) (radius 2.8194) (stroke (width 0.254)) (fill (type none)))
        (polyline
          (pts
            (xy 0.635 0.635)
            (xy 2.54 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.635 -0.635)
            (xy 2.54 -2.54)
            (xy 2.54 -2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.635 1.905)
            (xy 0.635 -1.905)
            (xy 0.635 -1.905)
          )
          (stroke (width 0.508)) (fill (type none))
        )
        (polyline
          (pts
            (xy 2.286 -1.778)
            (xy 1.778 -2.286)
            (xy 1.27 -1.27)
            (xy 2.286 -1.778)
            (xy 2.286 -1.778)
          )
          (stroke (width 0)) (fill (type outline))
        )
      )
      (symbol "BC807_1_1"
        (pin input line (at -5.08 0 0) (length 5.715)
          (name "B" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 2.54 -5.08 90) (length 2.54)
          (name "E" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 2.54 5.08 270) (length 2.54)
          (name "C" (effects (font (size 1.27 1.27))))
          (number "3" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "Transistor_BJT:BC817" (pin_names (offset 0) hide) (in_bom yes) (on_board yes)
      (property "Reference" "Q" (id 0) (at 5.08 1.905 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Value" "BC817" (id 1) (at 5.08 0 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Footprint" "Package_TO_SOT_SMD:SOT-23" (id 2) (at 5.08 -1.905 0)
        (effects (font (size 1.27 1.27) italic) (justify left) hide)
      )
      (property "Datasheet" "https://www.onsemi.com/pub/Collateral/BC818-D.pdf" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) (justify left) hide)
      )
      (property "ki_keywords" "NPN Transistor" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "0.8A Ic, 45V Vce, NPN Transistor, SOT-23" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_fp_filters" "SOT?23*" (id 6) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "BC817_0_1"
        (circle (center 1.27 0) (radius 2.8194) (stroke (width 0.254)) (fill (type none)))
        (polyline
          (pts
            (xy 0.635 0.635)
            (xy 2.54 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.635 -0.635)
            (xy 2.54 -2.54)
            (xy 2.54 -2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0.635 1.905)
            (xy 0.635 -1.905)
            (xy 0.635 -1.905)
          )
          (stroke (width 0.508)) (fill (type none))
        )
        (polyline
          (pts
            (xy 1.27 -1.778)
            (xy 1.778 -1.27)
            (xy 2.286 -2.286)
            (xy 1.27 -1.778)
            (xy 1.27 -1.778)
          )
          (stroke (width 0)) (fill (type outline))
        )
      )
      (symbol "BC817_1_1"
        (pin input line (at -5.08 0 0) (length 5.715)
          (name "B" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 2.54 -5.08 90) (length 2.54)
          (name "E" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 2.54 5.08 270) (length 2.54)
          (name "C" (effects (font (size 1.27 1.27))))
          (number "3" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "power:+3.3V" (power) (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "#PWR" (id 0) (at 0 -3.81 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Value" "+3.3V" (id 1) (at 0 3.556 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (id 2) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "power-flag" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Power symbol creates a global label with name \"+3.3V\"" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "+3.3V_0_1"
        (polyline
          (pts
            (xy -0.762 1.27)
            (xy 0 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0 0)
            (xy 0 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0 2.54)
            (xy 0.762 1.27)
          )
          (stroke (width 0)) (fill (type none))
        )
      )
      (symbol "+3.3V_1_1"
        (pin power_in line (at 0 0 90) (length 0) hide
          (name "+3V3" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "power:+5V" (power) (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "#PWR" (id 0) (at 0 -3.81 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Value" "+5V" (id 1) (at 0 3.556 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (id 2) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "power-flag" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Power symbol creates a global label with name \"+5V\"" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "+5V_0_1"
        (polyline
          (pts
            (xy -0.762 1.27)
            (xy 0 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0 0)
            (xy 0 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0 2.54)
            (xy 0.762 1.27)
          )
          (stroke (width 0)) (fill (type none))
        )
      )
      (symbol "+5V_1_1"
        (pin power_in line (at 0 0 90) (length 0) hide
          (name "+5V" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "power:+BATT" (power) (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "#PWR" (id 0) (at 0 -3.81 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Value" "+BATT" (id 1) (at 0 3.556 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (id 2) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "power-flag battery" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Power symbol creates a global label with name \"+BATT\"" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "+BATT_0_1"
        (polyline
          (pts
            (xy -0.762 1.27)
            (xy 0 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0 0)
            (xy 0 2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy 0 2.54)
            (xy 0.762 1.27)
          )
          (stroke (width 0)) (fill (type none))
        )
      )
      (symbol "+BATT_1_1"
        (pin power_in line (at 0 0 90) (length 0) hide
          (name "+BATT" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "power:GND" (power) (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "#PWR" (id 0) (at 0 -6.35 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Value" "GND" (id 1) (at 0 -3.81 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (id 2) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "power-flag" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Power symbol creates a global label with name \"GND\" , ground" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "GND_0_1"
        (polyline
          (pts
            (xy 0 0)
            (xy 0 -1.27)
            (xy 1.27 -1.27)
            (xy 0 -2.54)
            (xy -1.27 -1.27)
            (xy 0 -1.27)
          )
          (stroke (width 0)) (fill (type none))
        )
      )
      (symbol "GND_1_1"
        (pin power_in line (at 0 0 270) (length 0) hide
          (name "GND" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "pspice:DIODE" (pin_names (offset 1.016) hide) (in_bom yes) (on_board yes)
      (property "Reference" "D" (id 0) (at 0 3.81 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Value" "DIODE" (id 1) (at 0 -4.445 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (id 2) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "~" (id 3) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "simulation" (id 4) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Diode symbol for simulation only. Pin order incompatible with official kicad footprints" (id 5) (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "DIODE_0_1"
        (polyline
          (pts
            (xy 1.905 2.54)
            (xy 1.905 -2.54)
          )
          (stroke (width 0)) (fill (type none))
        )
        (polyline
          (pts
            (xy -1.905 2.54)
            (xy -1.905 -2.54)
            (xy 1.905 0)
          )
          (stroke (width 0)) (fill (type outline))
        )
      )
      (symbol "DIODE_1_1"
        (pin input line (at -5.08 0 0) (length 3.81)
          (name "K" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin input line (at 5.08 0 180) (length 3.81)
          (name "A" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
      )
    )
  )

  (junction (at 81.28 124.46) (diameter 1.016) (color 0 0 0 0))
  (junction (at 83.82 124.46) (diameter 1.016) (color 0 0 0 0))
  (junction (at 93.98 139.7) (diameter 1.016) (color 0 0 0 0))
  (junction (at 190.5 63.5) (diameter 1.016) (color 0 0 0 0))
  (junction (at 203.2 38.1) (diameter 1.016) (color 0 0 0 0))
  (junction (at 203.2 63.5) (diameter 1.016) (color 0 0 0 0))
  (junction (at 203.2 88.9) (diameter 1.016) (color 0 0 0 0))

  (wire (pts (xy 72.39 124.46) (xy 72.39 127))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 72.39 124.46) (xy 81.28 124.46))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 72.39 134.62) (xy 72.39 137.16))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 81.28 121.92) (xy 81.28 124.46))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 81.28 124.46) (xy 83.82 124.46))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 83.82 124.46) (xy 83.82 127))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 83.82 124.46) (xy 86.36 124.46))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 83.82 137.16) (xy 83.82 139.7))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 83.82 139.7) (xy 93.98 139.7))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 93.98 116.84) (xy 93.98 119.38))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 93.98 139.7) (xy 93.98 129.54))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 93.98 139.7) (xy 111.76 139.7))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 111.76 137.16) (xy 111.76 139.7))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 170.18 45.72) (xy 172.72 45.72))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 170.18 81.28) (xy 172.72 81.28))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 180.34 45.72) (xy 182.88 45.72))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 180.34 81.28) (xy 182.88 81.28))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 190.5 38.1) (xy 203.2 38.1))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 190.5 40.64) (xy 190.5 38.1))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 190.5 50.8) (xy 190.5 53.34))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 190.5 63.5) (xy 190.5 60.96))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 190.5 63.5) (xy 190.5 66.04))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 190.5 73.66) (xy 190.5 76.2))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 190.5 88.9) (xy 190.5 86.36))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 35.56) (xy 203.2 38.1))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 38.1) (xy 203.2 53.34))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 60.96) (xy 203.2 63.5))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 63.5) (xy 190.5 63.5))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 63.5) (xy 203.2 66.04))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 63.5) (xy 205.74 63.5))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 73.66) (xy 203.2 88.9))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 88.9) (xy 190.5 88.9))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (wire (pts (xy 203.2 88.9) (xy 203.2 91.44))
    (stroke (width 0) (type solid) (color 0 0 0 0))
  )
  (polyline (pts (xy 156.21 21.59) (xy 156.21 99.06))
    (stroke (width 0) (type dash) (color 0 0 0 0))
  )
  (polyline (pts (xy 156.21 21.59) (xy 214.63 21.59))
    (stroke (width 0) (type dash) (color 0 0 0 0))
  )
  (polyline (pts (xy 214.63 21.59) (xy 214.63 99.06))
    (stroke (width 0) (type dash) (color 0 0 0 0))
  )
  (polyline (pts (xy 214.63 99.06) (xy 156.21 99.06))
    (stroke (width 0) (type dash) (color 0 0 0 0))
  )

  (text "TODO: add jumpers as a precaution if this does not work"
    (at 49.53 149.86 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
  )
  (text "TODO: Difference between 3,3V and\nV_Batt has to be greater than Vgs"
    (at 120.65 121.92 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
  )
  (text "TODO: The diode has to be one with very little voltage drop\notherwise the microcontroller may not program correctly"
    (at 120.65 128.27 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
  )
  (text "The MCU periodically measures the voltage of the\nindividual cells and then switches one of the transistors\nto drain the cell with the higher voltage."
    (at 157.48 29.21 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
  )

  (hierarchical_label "VCC_SW" (shape input) (at 111.76 137.16 90)
    (effects (font (size 1.27 1.27)) (justify left))
  )
  (hierarchical_label "~BAL_HIGH" (shape input) (at 170.18 45.72 180)
    (effects (font (size 1.27 1.27)) (justify right))
  )
  (hierarchical_label "BAL_LOW" (shape input) (at 170.18 81.28 180)
    (effects (font (size 1.27 1.27)) (justify right))
  )
  (hierarchical_label "VMID" (shape output) (at 205.74 63.5 0)
    (effects (font (size 1.27 1.27)) (justify left))
  )

  (symbol (lib_id "power:+5V") (at 40.64 34.29 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "b948eed3-787f-47a4-8871-24e51a945e2e")
    (property "Reference" "#PWR0127" (id 0) (at 40.64 38.1 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "+5V" (id 1) (at 41.0083 29.9656 0))
    (property "Footprint" "" (id 2) (at 40.64 34.29 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (id 3) (at 40.64 34.29 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "power:+3.3V") (at 81.28 121.92 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "513f966b-4495-4990-b182-5526dff63093")
    (property "Reference" "#PWR0126" (id 0) (at 81.28 125.73 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "+3.3V_programmer" (id 1) (at 81.648 117.596 0))
    (property "Footprint" "" (id 2) (at 81.28 121.92 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (id 3) (at 81.28 121.92 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "power:+BATT") (at 93.98 116.84 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "84df1307-86f3-47b4-a1aa-8cb15884156f")
    (property "Reference" "#PWR0125" (id 0) (at 93.98 120.65 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "+BATT" (id 1) (at 94.3483 112.5156 0))
    (property "Footprint" "" (id 2) (at 93.98 116.84 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (id 3) (at 93.98 116.84 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "power:+BATT") (at 203.2 35.56 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "aa915fe6-7dac-4f9a-857c-e725e5ef3866")
    (property "Reference" "#PWR?" (id 0) (at 203.2 39.37 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "+BATT" (id 1) (at 203.5683 31.2356 0))
    (property "Footprint" "" (id 2) (at 203.2 35.56 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (id 3) (at 203.2 35.56 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "power:GND") (at 72.39 137.16 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "fcf91b1c-89df-48d3-a079-670ff776b9bc")
    (property "Reference" "#PWR0128" (id 0) (at 72.39 143.51 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "GND" (id 1) (at 72.5043 141.4844 0))
    (property "Footprint" "" (id 2) (at 72.39 137.16 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (id 3) (at 72.39 137.16 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "power:GND") (at 203.2 91.44 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "0a8d1d2c-8ca0-444c-9bf9-6b122bc86b62")
    (property "Reference" "#PWR?" (id 0) (at 203.2 97.79 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "GND" (id 1) (at 203.3143 95.7644 0))
    (property "Footprint" "" (id 2) (at 203.2 91.44 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (id 3) (at 203.2 91.44 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Device:R") (at 72.39 130.81 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "94b1480c-21b6-4ef7-b592-3977ba8ffc39")
    (property "Reference" "R7" (id 0) (at 74.1681 129.6606 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "R" (id 1) (at 74.1681 131.9593 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "" (id 2) (at 70.612 130.81 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 72.39 130.81 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Device:R") (at 176.53 45.72 90) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "b2dec339-4fed-4339-bfd9-7be8a1592b01")
    (property "Reference" "R?" (id 0) (at 175.3806 43.9419 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "1K" (id 1) (at 177.679 43.942 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "Resistor_SMD:R_0603_1608Metric" (id 2) (at 176.53 47.498 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 176.53 45.72 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Device:R") (at 176.53 81.28 90) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "4e46ac48-fa3e-4083-bb54-f329eaaf2b5c")
    (property "Reference" "R?" (id 0) (at 175.3806 79.5019 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "1K" (id 1) (at 177.679 79.502 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "Resistor_SMD:R_0603_1608Metric" (id 2) (at 176.53 83.058 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 176.53 81.28 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Device:R") (at 190.5 57.15 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "1526fa3f-0091-4af1-a345-d1d827a8491f")
    (property "Reference" "R?" (id 0) (at 192.2781 56.0006 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "30" (id 1) (at 192.278 58.299 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "Resistor_SMD:R_0603_1608Metric" (id 2) (at 188.722 57.15 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 190.5 57.15 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Device:R") (at 190.5 69.85 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "2c8f006d-ba7c-4c71-b9c4-c2bdabaa2b7f")
    (property "Reference" "R?" (id 0) (at 192.2781 68.7006 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "30" (id 1) (at 192.278 70.999 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "Resistor_SMD:R_0603_1608Metric" (id 2) (at 188.722 69.85 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 190.5 69.85 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Device:Battery_Cell") (at 203.2 58.42 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "210515f0-c0f1-4f80-b920-f3ce9df10676")
    (property "Reference" "BT1" (id 0) (at 209.3152 58.42 90))
    (property "Value" "NiMH" (id 1) (at 207.017 58.42 90))
    (property "Footprint" "" (id 2) (at 203.2 56.896 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 203.2 56.896 90)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Device:Battery_Cell") (at 203.2 71.12 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "eda3ac85-180c-4149-a69c-6ee2b133cab0")
    (property "Reference" "BT2" (id 0) (at 209.3152 71.12 90))
    (property "Value" "NiMH" (id 1) (at 207.017 71.12 90))
    (property "Footprint" "" (id 2) (at 203.2 69.596 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 203.2 69.596 90)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "pspice:DIODE") (at 83.82 132.08 270) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "d97a629e-f5e3-4e10-a29b-be0ad1d5f5ac")
    (property "Reference" "D48" (id 0) (at 86.9951 130.9306 90)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "DIODE" (id 1) (at 86.9951 133.2293 90)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "" (id 2) (at 83.82 132.08 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 83.82 132.08 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "Transistor_BJT:BC807") (at 187.96 45.72 0) (mirror x) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "6d2d8e94-9b52-47a3-82d5-7aad13d197bb")
    (property "Reference" "Q?" (id 0) (at 192.8115 44.5706 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "BC807" (id 1) (at 192.8115 46.8693 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "Package_TO_SOT_SMD:SOT-23" (id 2) (at 193.04 43.815 0)
      (effects (font (size 1.27 1.27) italic) (justify left) hide)
    )
    (property "Datasheet" "https://www.onsemi.com/pub/Collateral/BC808-D.pdf" (id 3) (at 187.96 45.72 0)
      (effects (font (size 1.27 1.27)) (justify left) hide)
    )
  )

  (symbol (lib_id "Transistor_BJT:BC817") (at 187.96 81.28 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "4db612db-af35-48db-a235-6fa2f8862a88")
    (property "Reference" "Q?" (id 0) (at 192.8115 80.1306 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "BC817" (id 1) (at 192.8115 82.4293 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "Package_TO_SOT_SMD:SOT-23" (id 2) (at 193.04 83.185 0)
      (effects (font (size 1.27 1.27) italic) (justify left) hide)
    )
    (property "Datasheet" "https://www.onsemi.com/pub/Collateral/BC818-D.pdf" (id 3) (at 187.96 81.28 0)
      (effects (font (size 1.27 1.27)) (justify left) hide)
    )
  )

  (symbol (lib_id "Device:Q_PMOS_DGS") (at 91.44 124.46 0) (unit 1)
    (in_bom yes) (on_board yes)
    (uuid "f0252d66-95ed-4e48-8ba2-5d7673eeffb0")
    (property "Reference" "Q1" (id 0) (at 96.6471 123.3106 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "Q_PMOS_DGS" (id 1) (at 96.6471 125.6093 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "" (id 2) (at 96.52 121.92 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (id 3) (at 91.44 124.46 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
)
